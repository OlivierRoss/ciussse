<!DOCTYPE html>
<html lang="fr">
  <head>
    <title>Disponibilités des organismes communautaires</title>
    <link rel="stylesheet" href="style.css" />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans|Roboto&display=swap" rel="stylesheet">
    <link href="https://cdn.datatables.net/1.10.20/css/jquery.dataTables.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
    <script src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"></script>
  </head>

  <body>
    <header>
      <h1>COVID-19</h1>
    </header>
    <section id="approche">
      <p> Texte de presentation </p>
    </section>
    <section id="section-table">
      <table id="table"> </table>
    </section>
    <footer>
      <p>Cet outil est une initiative du CIUSSSE</p>
    </footer>
  <script type="text/javascript">

    async function get_data () {
      let response = await fetch("https://sheets.googleapis.com/v4/spreadsheets/1inmEtfz_sZeA1bI6n2y581WnwOm44B-KTAxhacw2vJY/values/'IGNORER - Données publiques'!A:H?key=AIzaSyAl3TfynOtVS2PQRKyJPWxJShQdESCvsy4");

      if (response.ok) { // if HTTP-status is 200-299
        // get the response body (the method explained below)
        let json = await response.json();
        console.log(json.values.slice(1));
        $('#table').DataTable( {
          data: json.values.slice(1),
          columns: json.values.slice(0, 1)[0].map((col) => { return {title: col} })
        });
      } else {
        alert("HTTP-Error: " + response.status);
      }
    }

window.onload = get_data;
  </script>
  </body>
</html>
